@using Microsoft.AspNetCore.Components
@inject NavigationManager NavigationManager

<ErrorBoundary @ref="errorBoundary">
    <ChildContent>
        <Router AppAssembly="typeof(Program).Assembly">
            <Found Context="routeData">
                <RouteView RouteData="routeData" DefaultLayout="typeof(Layout.MainLayout)" />
                <FocusOnNavigate RouteData="routeData" Selector="h1" />
            </Found>
        </Router>
    </ChildContent>
    <ErrorContent>
        <div class="error-boundary">
            <div class="error-boundary-content">
                <div class="error-icon">⚠️</div>
                <h2>Algo salió mal</h2>
                <p class="error-message">
                    Ha ocurrido un error inesperado. Por favor, intenta recargar la página.
                </p>
                <div class="error-actions">
                    <button class="btn btn-primary" @onclick="Recover">
                        Intentar de nuevo
                    </button>
                    <button class="btn btn-secondary" @onclick="ReloadPage">
                        Recargar página
                    </button>
                </div>
            </div>
        </div>
    </ErrorContent>
</ErrorBoundary>

@code {
    private ErrorBoundary? errorBoundary;

    private void Recover()
    {
        errorBoundary?.Recover();
    }

    private void ReloadPage()
    {
        NavigationManager.NavigateTo(NavigationManager.Uri, forceLoad: true);
    }
}

<style>
    .error-boundary {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 400px;
        padding: 2rem;
    }

    .error-boundary-content {
        max-width: 600px;
        text-align: center;
        background: var(--bs-danger-bg-subtle, #f8d7da);
        border: 1px solid var(--bs-danger-border-subtle, #f5c2c7);
        border-radius: 8px;
        padding: 2rem;
    }

    .error-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
    }

    .error-boundary-content h2 {
        color: var(--bs-danger, #dc3545);
        margin-bottom: 1rem;
    }

    .error-message {
        color: var(--bs-danger-text-emphasis, #721c24);
        margin-bottom: 1.5rem;
        font-size: 1.1rem;
    }

    .error-actions {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 1.5rem;
    }

    .btn {
        padding: 0.5rem 1.5rem;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.2s;
    }

    .btn-primary {
        background: var(--bs-primary, #0d6efd);
        color: white;
    }

    .btn-primary:hover {
        background: var(--bs-primary-dark, #0b5ed7);
    }

    .btn-secondary {
        background: var(--bs-secondary, #6c757d);
        color: white;
    }

    .btn-secondary:hover {
        background: var(--bs-secondary-dark, #5c636a);
    }
</style>
